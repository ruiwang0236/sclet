<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 SVP | sclet: A Lightweight Toolkit for Single-Cell Data Analysis</title>
  <meta name="description" content="4 SVP | sclet: A Lightweight Toolkit for Single-Cell Data Analysis" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="4 SVP | sclet: A Lightweight Toolkit for Single-Cell Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 SVP | sclet: A Lightweight Toolkit for Single-Cell Data Analysis" />
  
  
  



<meta name="date" content="2024-10-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cell-cell-communication.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="basic-preprocessing-and-clustering.html"><a href="basic-preprocessing-and-clustering.html"><i class="fa fa-check"></i><b>1</b> Basic: preprocessing and clustering</a>
<ul>
<li class="chapter" data-level="1.1" data-path="basic-preprocessing-and-clustering.html"><a href="basic-preprocessing-and-clustering.html#read-10x-data"><i class="fa fa-check"></i><b>1.1</b> Read 10X data</a></li>
<li class="chapter" data-level="1.2" data-path="basic-preprocessing-and-clustering.html"><a href="basic-preprocessing-and-clustering.html#qc"><i class="fa fa-check"></i><b>1.2</b> QC</a></li>
<li class="chapter" data-level="1.3" data-path="basic-preprocessing-and-clustering.html"><a href="basic-preprocessing-and-clustering.html#variable-features"><i class="fa fa-check"></i><b>1.3</b> Variable features</a></li>
<li class="chapter" data-level="1.4" data-path="basic-preprocessing-and-clustering.html"><a href="basic-preprocessing-and-clustering.html#dimensional-reduction"><i class="fa fa-check"></i><b>1.4</b> Dimensional reduction</a></li>
<li class="chapter" data-level="1.5" data-path="basic-preprocessing-and-clustering.html"><a href="basic-preprocessing-and-clustering.html#FindClusters"><i class="fa fa-check"></i><b>1.5</b> Clustering</a></li>
<li class="chapter" data-level="1.6" data-path="basic-preprocessing-and-clustering.html"><a href="basic-preprocessing-and-clustering.html#umap"><i class="fa fa-check"></i><b>1.6</b> UMAP</a></li>
<li class="chapter" data-level="1.7" data-path="basic-preprocessing-and-clustering.html"><a href="basic-preprocessing-and-clustering.html#find-markers"><i class="fa fa-check"></i><b>1.7</b> Find Markers</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="basic-preprocessing-and-clustering.html"><a href="basic-preprocessing-and-clustering.html#marker-gene-information"><i class="fa fa-check"></i><b>1.7.1</b> Marker gene information</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="basic-preprocessing-and-clustering.html"><a href="basic-preprocessing-and-clustering.html#manual-annotation"><i class="fa fa-check"></i><b>1.8</b> Cell cluster annotation</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cell-type-annotation.html"><a href="cell-type-annotation.html"><i class="fa fa-check"></i><b>2</b> Cell type annotation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cell-type-annotation.html"><a href="cell-type-annotation.html#manual-annotation-1"><i class="fa fa-check"></i><b>2.1</b> Manual annotation</a></li>
<li class="chapter" data-level="2.2" data-path="cell-type-annotation.html"><a href="cell-type-annotation.html#automat-annotation"><i class="fa fa-check"></i><b>2.2</b> Automat annotation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="cell-type-annotation.html"><a href="cell-type-annotation.html#run-singler"><i class="fa fa-check"></i><b>2.2.1</b> Run SingleR</a></li>
<li class="chapter" data-level="2.2.2" data-path="cell-type-annotation.html"><a href="cell-type-annotation.html#annotate-with-singler-result"><i class="fa fa-check"></i><b>2.2.2</b> Annotate with SingleR result</a></li>
<li class="chapter" data-level="2.2.3" data-path="cell-type-annotation.html"><a href="cell-type-annotation.html#comparision-with-manual-annotation-result"><i class="fa fa-check"></i><b>2.2.3</b> Comparision with manual annotation result</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cell-cell-communication.html"><a href="cell-cell-communication.html"><i class="fa fa-check"></i><b>3</b> Cell-cell communication</a>
<ul>
<li class="chapter" data-level="3.1" data-path="cell-cell-communication.html"><a href="cell-cell-communication.html#input"><i class="fa fa-check"></i><b>3.1</b> Input</a></li>
<li class="chapter" data-level="3.2" data-path="cell-cell-communication.html"><a href="cell-cell-communication.html#cellchat"><i class="fa fa-check"></i><b>3.2</b> CellChat</a></li>
<li class="chapter" data-level="3.3" data-path="cell-cell-communication.html"><a href="cell-cell-communication.html#visulization"><i class="fa fa-check"></i><b>3.3</b> visulization</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="svp.html"><a href="svp.html"><i class="fa fa-check"></i><b>4</b> SVP</a>
<ul>
<li class="chapter" data-level="4.1" data-path="svp.html"><a href="svp.html#runsgsa"><i class="fa fa-check"></i><b>4.1</b> runSGSA</a></li>
<li class="chapter" data-level="4.2" data-path="svp.html"><a href="svp.html#runlisa"><i class="fa fa-check"></i><b>4.2</b> runLISA</a></li>
<li class="chapter" data-level="4.3" data-path="svp.html"><a href="svp.html#runlocalbv"><i class="fa fa-check"></i><b>4.3</b> runLOCALBV</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">sclet: A Lightweight Toolkit for Single-Cell Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="svp" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> SVP<a href="svp.html#svp" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Robust analysis of ‘gene set’ activity in spatial or single-cell data.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="svp.html#cb52-1" tabindex="-1"></a><span class="fu">library</span>(SpatialExperiment)</span>
<span id="cb52-2"><a href="svp.html#cb52-2" tabindex="-1"></a><span class="fu">library</span>(SingleCellExperiment)</span>
<span id="cb52-3"><a href="svp.html#cb52-3" tabindex="-1"></a><span class="fu">library</span>(scuttle)</span>
<span id="cb52-4"><a href="svp.html#cb52-4" tabindex="-1"></a><span class="fu">library</span>(SVP)</span>
<span id="cb52-5"><a href="svp.html#cb52-5" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb52-6"><a href="svp.html#cb52-6" tabindex="-1"></a><span class="fu">library</span>(ggsc)</span></code></pre></div>
<div id="runsgsa" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> runSGSA<a href="svp.html#runsgsa" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Calculate the activity of gene sets in spatial or single-cell data with restart walk with restart and hyper test weighted.
sceSubPbmc is a small SingleCellExperiment data set from pbmck3 which contains 1304 genes and 800 cells (extract randomly).</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="svp.html#cb53-1" tabindex="-1"></a><span class="fu">data</span>(sceSubPbmc)</span>
<span id="cb53-2"><a href="svp.html#cb53-2" tabindex="-1"></a>sceSubPbmc <span class="ot">&lt;-</span> scuttle<span class="sc">::</span><span class="fu">logNormCounts</span>(sceSubPbmc)</span>
<span id="cb53-3"><a href="svp.html#cb53-3" tabindex="-1"></a><span class="co"># the using runMCA to perform MCA (Multiple Correspondence Analysis)</span></span>
<span id="cb53-4"><a href="svp.html#cb53-4" tabindex="-1"></a><span class="co"># this is refer to the CelliD, but we using the Eigen to speed up.</span></span>
<span id="cb53-5"><a href="svp.html#cb53-5" tabindex="-1"></a><span class="co"># You can view the help information of runMCA using ?runMCA.</span></span>
<span id="cb53-6"><a href="svp.html#cb53-6" tabindex="-1"></a>sceSubPbmc <span class="ot">&lt;-</span> <span class="fu">runMCA</span>(sceSubPbmc, <span class="at">assay.type =</span> <span class="st">&#39;logcounts&#39;</span>)</span></code></pre></div>
<p>CellCycle.Hs is the S and G2M gene list are from the Seurat which refer to this article (<a href="doi:10.1126/science.aad050" class="uri">doi:10.1126/science.aad050</a>), the G1 gene list is from the G1_PHASE of Human Gene Set in MSigDB, but remove the duplicated records with S and G2M gene list.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="svp.html#cb54-1" tabindex="-1"></a><span class="co"># Next, we can calculate the activity score of gene sets provided.</span></span>
<span id="cb54-2"><a href="svp.html#cb54-2" tabindex="-1"></a><span class="co"># Here, we use the Cell Cycle gene set from the Seurat </span></span>
<span id="cb54-3"><a href="svp.html#cb54-3" tabindex="-1"></a><span class="co"># You can use other gene set, such as KEGG pathway, GO, Hallmark of MSigDB</span></span>
<span id="cb54-4"><a href="svp.html#cb54-4" tabindex="-1"></a><span class="co"># or TFs gene sets etc.</span></span>
<span id="cb54-5"><a href="svp.html#cb54-5" tabindex="-1"></a><span class="fu">data</span>(CellCycle.Hs)</span>
<span id="cb54-6"><a href="svp.html#cb54-6" tabindex="-1"></a>sceSubPbmc <span class="ot">&lt;-</span> <span class="fu">runSGSA</span>(sceSubPbmc, <span class="at">gset.idx.list =</span> CellCycle.Hs, <span class="at">gsvaExp.name =</span> <span class="st">&#39;CellCycle&#39;</span>)</span></code></pre></div>
<pre><code>## elapsed time is 1.090000 seconds</code></pre>
<pre><code>## elapsed time is 0.020000 seconds</code></pre>
<pre><code>## elapsed time is 0.030000 seconds</code></pre>
<pre><code>## elapsed time is 0.020000 seconds</code></pre>
<pre><code>## elapsed time is 0.020000 seconds</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="svp.html#cb60-1" tabindex="-1"></a><span class="co"># Then a SVPE class which inherits SingleCellExperiment, is return.</span></span>
<span id="cb60-2"><a href="svp.html#cb60-2" tabindex="-1"></a>sceSubPbmc</span></code></pre></div>
<pre><code>## class: SVPExperiment 
## dim: 1304 800 
## metadata(0):
## assays(2): counts logcounts
## rownames(1304): LYZ GNG7 ... TAF1 TBRG4
## rowData names(0):
## colnames(800): ACGAACTGGCTATG GGGCCAACCTTGGA ...
##   TTCAAGCTAAGAAC TTACACACGTGTTG
## colData names(2): seurat_annotations sizeFactor
## reducedDimNames(1): MCA
## mainExpName: RNA
## altExpNames(0):
## spatialCoords names(0) :
## imgData names(0):
## gsvaExps names(1) : CellCycle</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="svp.html#cb62-1" tabindex="-1"></a><span class="co"># You can obtaion the score matrix by following the commond</span></span>
<span id="cb62-2"><a href="svp.html#cb62-2" tabindex="-1"></a>sceSubPbmc <span class="sc">|&gt;</span> <span class="fu">gsvaExp</span>(<span class="st">&#39;CellCycle&#39;</span>) </span></code></pre></div>
<pre><code>## class: SingleCellExperiment 
## dim: 3 800 
## metadata(0):
## assays(1): affi.score
## rownames(3): S G2M G1
## rowData names(4): exp.gene.num gset.gene.num
##   gene.occurrence.rate geneSets
## colnames(800): ACGAACTGGCTATG GGGCCAACCTTGGA ...
##   TTCAAGCTAAGAAC TTACACACGTGTTG
## colData names(2): seurat_annotations sizeFactor
## reducedDimNames(0):
## mainExpName: NULL
## altExpNames(0):</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="svp.html#cb64-1" tabindex="-1"></a>sceSubPbmc <span class="sc">|&gt;</span> <span class="fu">gsvaExp</span>(<span class="st">&quot;CellCycle&quot;</span>) <span class="sc">|&gt;</span> <span class="fu">assay</span>() <span class="sc">|&gt;</span> <span class="fu">t</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## 6 x 3 sparse Matrix of class &quot;dgCMatrix&quot;
##                           S          G2M           G1
## ACGAACTGGCTATG 8.912990e-04 1.626142e-05 7.207289e-06
## GGGCCAACCTTGGA 9.413528e-06 1.606825e-09 2.603956e-08
## ACGAGGGACAGGAG 1.416664e-05 1.025511e-04 7.967855e-04
## CAGGTTGAGGATCT 1.322563e-06 1.550434e-12 1.456777e-11
## CATACTTGGGTTAC 4.964354e-05 6.391833e-04 8.241869e-04
## AAGCCATGAACTGC 5.136016e-04 7.587088e-05 8.797016e-04</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="svp.html#cb66-1" tabindex="-1"></a><span class="co"># Then you can use the ggsc or other package to visulize</span></span>
<span id="cb66-2"><a href="svp.html#cb66-2" tabindex="-1"></a><span class="co"># and you can try to use the findMarkers of scran or other packages to identify</span></span>
<span id="cb66-3"><a href="svp.html#cb66-3" tabindex="-1"></a><span class="co"># the different gene sets.   </span></span>
<span id="cb66-4"><a href="svp.html#cb66-4" tabindex="-1"></a>sceSubPbmc <span class="ot">&lt;-</span> sceSubPbmc <span class="sc">|&gt;</span> </span>
<span id="cb66-5"><a href="svp.html#cb66-5" tabindex="-1"></a>                scater<span class="sc">::</span><span class="fu">runPCA</span>(<span class="at">assay.type =</span> <span class="st">&#39;logcounts&#39;</span>, <span class="at">ntop =</span> <span class="dv">600</span>) <span class="sc">|&gt;</span></span>
<span id="cb66-6"><a href="svp.html#cb66-6" tabindex="-1"></a>                scater<span class="sc">::</span><span class="fu">runUMAP</span>(<span class="at">dimred =</span> <span class="st">&#39;PCA&#39;</span>)</span>
<span id="cb66-7"><a href="svp.html#cb66-7" tabindex="-1"></a><span class="co"># withReducedDim = TRUE, the original reducetion results from original gene features</span></span>
<span id="cb66-8"><a href="svp.html#cb66-8" tabindex="-1"></a><span class="co"># will be add the colData in the sce.cellcycle.</span></span>
<span id="cb66-9"><a href="svp.html#cb66-9" tabindex="-1"></a>sce.cellcycle <span class="ot">&lt;-</span> sceSubPbmc <span class="sc">|&gt;</span> <span class="fu">gsvaExp</span>(<span class="st">&#39;CellCycle&#39;</span>, <span class="at">withReducedDim=</span><span class="cn">TRUE</span>)</span>
<span id="cb66-10"><a href="svp.html#cb66-10" tabindex="-1"></a>sce.cellcycle</span></code></pre></div>
<pre><code>## class: SingleCellExperiment 
## dim: 3 800 
## metadata(0):
## assays(1): affi.score
## rownames(3): S G2M G1
## rowData names(4): exp.gene.num gset.gene.num
##   gene.occurrence.rate geneSets
## colnames(800): ACGAACTGGCTATG GGGCCAACCTTGGA ...
##   TTCAAGCTAAGAAC TTACACACGTGTTG
## colData names(2): seurat_annotations sizeFactor
## reducedDimNames(3): MCA PCA UMAP
## mainExpName: NULL
## altExpNames(0):</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="svp.html#cb68-1" tabindex="-1"></a>sce.cellcycle <span class="sc">|&gt;</span> <span class="fu">sc_violin</span>(</span>
<span id="cb68-2"><a href="svp.html#cb68-2" tabindex="-1"></a>                      <span class="at">features =</span> <span class="fu">rownames</span>(sce.cellcycle), </span>
<span id="cb68-3"><a href="svp.html#cb68-3" tabindex="-1"></a>                      <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>seurat_annotations, <span class="at">fill =</span> seurat_annotations)</span>
<span id="cb68-4"><a href="svp.html#cb68-4" tabindex="-1"></a>                   ) <span class="sc">+</span> </span>
<span id="cb68-5"><a href="svp.html#cb68-5" tabindex="-1"></a>                   <span class="fu">scale_x_discrete</span>(<span class="at">guide=</span><span class="fu">guide_axis</span>(<span class="at">angle=</span><span class="sc">-</span><span class="dv">45</span>))</span></code></pre></div>
<p><img src="sclet_files/figure-html/svp-cc-violin-1.png" width="960" /></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="svp.html#cb69-1" tabindex="-1"></a>sce.cellcycle <span class="sc">|&gt;</span> <span class="fu">sc_feature</span>(<span class="at">features=</span> <span class="st">&quot;S&quot;</span>, <span class="at">reduction=</span><span class="st">&#39;UMAP&#39;</span>)</span></code></pre></div>
<p><img src="sclet_files/figure-html/svp-cc-s-umap-1.png" width="960" /></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="svp.html#cb70-1" tabindex="-1"></a><span class="fu">library</span>(scran)</span>
<span id="cb70-2"><a href="svp.html#cb70-2" tabindex="-1"></a>cellcycle.test.res <span class="ot">&lt;-</span> sce.cellcycle <span class="sc">|&gt;</span> <span class="fu">findMarkers</span>(</span>
<span id="cb70-3"><a href="svp.html#cb70-3" tabindex="-1"></a>                <span class="at">group =</span> sce.cellcycle<span class="sc">$</span>seurat_annotations, </span>
<span id="cb70-4"><a href="svp.html#cb70-4" tabindex="-1"></a>                <span class="at">test.type =</span> <span class="st">&#39;wilcox&#39;</span>, </span>
<span id="cb70-5"><a href="svp.html#cb70-5" tabindex="-1"></a>                <span class="at">assay.type =</span> <span class="st">&#39;affi.score&#39;</span>, </span>
<span id="cb70-6"><a href="svp.html#cb70-6" tabindex="-1"></a>                <span class="at">add.summary =</span> <span class="cn">TRUE</span></span>
<span id="cb70-7"><a href="svp.html#cb70-7" tabindex="-1"></a>                )</span>
<span id="cb70-8"><a href="svp.html#cb70-8" tabindex="-1"></a>cellcycle.test.res<span class="sc">$</span>B</span></code></pre></div>
<pre><code>## DataFrame with 3 rows and 16 columns
##     self.average other.average self.detected other.detected
##        &lt;numeric&gt;     &lt;numeric&gt;     &lt;numeric&gt;      &lt;numeric&gt;
## S    0.000615131   0.000889084             1              1
## G2M  0.000760345   0.000723091             1              1
## G1   0.000914127   0.000891885             1              1
##           Top     p.value         FDR summary.AUC
##     &lt;integer&gt;   &lt;numeric&gt;   &lt;numeric&gt;   &lt;numeric&gt;
## S           1 1.23356e-03 1.85034e-03    0.681366
## G2M         1 5.34716e-06 1.60415e-05    0.738194
## G1          1 1.70067e-02 1.70067e-02    0.354864
##     AUC.Naive CD4 T AUC.Memory CD4 T AUC.CD14+ Mono
##           &lt;numeric&gt;        &lt;numeric&gt;      &lt;numeric&gt;
## S          0.503904         0.425679       0.681366
## G2M        0.588138         0.496889       0.738194
## G1         0.401351         0.354864       0.504861
##     AUC.CD8 T AUC.FCGR3A+ Mono    AUC.NK    AUC.DC
##     &lt;numeric&gt;        &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
## S    0.400000         0.591453  0.238384  0.682437
## G2M  0.444444         0.556239  0.432323  0.701792
## G1   0.333333         0.394530  0.345455  0.513978
##     AUC.Platelet
##        &lt;numeric&gt;
## S       0.222222
## G2M     0.955556
## G1      0.977778</code></pre>
</div>
<div id="runlisa" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> runLISA<a href="svp.html#runlisa" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>hpda_spe_cell_dec is the result of runSGSA with HPDA A sample from (<a href="doi:10.1038/s41587-019-0392-8" class="uri">doi:10.1038/s41587-019-0392-8</a>).
Each item in the matrix is the marker gene set activity in the spot. The marker gene set represents the cell type.
We can use svp the investigate if a cell type cluters and if two cell types appear in the same region.
Usage of local indicators of spatial association (LISA) to identify the hotspot in the spatial space</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="svp.html#cb72-1" tabindex="-1"></a><span class="fu">data</span>(hpda_spe_cell_dec)</span>
<span id="cb72-2"><a href="svp.html#cb72-2" tabindex="-1"></a></span>
<span id="cb72-3"><a href="svp.html#cb72-3" tabindex="-1"></a><span class="co"># r$&gt; assay(hpda_spe_cell_dec)[1:5,1:5]</span></span>
<span id="cb72-4"><a href="svp.html#cb72-4" tabindex="-1"></a><span class="co"># 5 x 5 sparse Matrix of class &quot;dgCMatrix&quot;</span></span>
<span id="cb72-5"><a href="svp.html#cb72-5" tabindex="-1"></a><span class="co">#                                             Spot1        Spot2        Spot3        Spot4        Spot5</span></span>
<span id="cb72-6"><a href="svp.html#cb72-6" tabindex="-1"></a><span class="co"># Acinar cells                         3.283881e-04 6.931743e-06 4.820951e-05 1.882577e-03 9.269843e-04</span></span>
<span id="cb72-7"><a href="svp.html#cb72-7" tabindex="-1"></a><span class="co"># Cancer clone A                       2.880388e-04 2.013973e-04 9.167013e-05 9.642225e-05 6.704812e-05</span></span>
<span id="cb72-8"><a href="svp.html#cb72-8" tabindex="-1"></a><span class="co"># Cancer clone B                       1.569730e-04 2.744810e-04 2.151324e-04 1.502651e-05 4.283322e-06</span></span>
<span id="cb72-9"><a href="svp.html#cb72-9" tabindex="-1"></a><span class="co"># Ductal APOL1 high-hypoxic            3.132481e-05 3.902286e-04 4.240874e-05 3.140970e-06 1.464118e-04</span></span>
<span id="cb72-10"><a href="svp.html#cb72-10" tabindex="-1"></a><span class="co"># Ductal CRISP3 high-centroacinar like 9.546611e-05 5.025320e-03 2.112512e-03 1.140155e-03 3.873088e-03</span></span>
<span id="cb72-11"><a href="svp.html#cb72-11" tabindex="-1"></a></span>
<span id="cb72-12"><a href="svp.html#cb72-12" tabindex="-1"></a>svres <span class="ot">&lt;-</span> <span class="fu">runDetectSVG</span>(hpda_spe_cell_dec, <span class="at">assay.type =</span> <span class="st">&#39;affi.score&#39;</span>, </span>
<span id="cb72-13"><a href="svp.html#cb72-13" tabindex="-1"></a>                      <span class="at">method =</span> <span class="st">&#39;moransi&#39;</span>, <span class="at">action =</span> <span class="st">&#39;only&#39;</span>) </span></code></pre></div>
<pre><code>## elapsed time is 0.070000 seconds</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="svp.html#cb74-1" tabindex="-1"></a><span class="co"># r$&gt; svres |&gt; dplyr::arrange(rank) |&gt; head()</span></span>
<span id="cb74-2"><a href="svp.html#cb74-2" tabindex="-1"></a><span class="co">#                                            obs expect.moransi sd.moransi Z.moransi        pvalue          padj rank</span></span>
<span id="cb74-3"><a href="svp.html#cb74-3" tabindex="-1"></a><span class="co"># Cancer clone A                       0.7086916    -0.00234192 0.02803920  25.35855 3.616015e-142 7.232030e-141    1</span></span>
<span id="cb74-4"><a href="svp.html#cb74-4" tabindex="-1"></a><span class="co"># Acinar cells                         0.6958980    -0.00234192 0.02788076  25.04379 1.020141e-138 1.020141e-137    2</span></span>
<span id="cb74-5"><a href="svp.html#cb74-5" tabindex="-1"></a><span class="co"># Cancer clone B                       0.6586104    -0.00234192 0.02803039  23.57985 3.102650e-123 2.068434e-122    3</span></span>
<span id="cb74-6"><a href="svp.html#cb74-6" tabindex="-1"></a><span class="co"># mDCs A                               0.5824019    -0.00234192 0.02760394  21.18334 6.801396e-100  3.400698e-99    4</span></span>
<span id="cb74-7"><a href="svp.html#cb74-7" tabindex="-1"></a><span class="co"># Ductal CRISP3 high-centroacinar like 0.5605955    -0.00234192 0.02794187  20.14673  1.437344e-90  5.749375e-90    5</span></span>
<span id="cb74-8"><a href="svp.html#cb74-8" tabindex="-1"></a><span class="co"># Endothelial cells                    0.5362475    -0.00234192 0.02757573  19.53128  2.976221e-85  9.920735e-85    6</span></span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="svp.html#cb75-1" tabindex="-1"></a>lisa.res12 <span class="ot">&lt;-</span> hpda_spe_cell_dec <span class="sc">|&gt;</span></span>
<span id="cb75-2"><a href="svp.html#cb75-2" tabindex="-1"></a>   <span class="fu">runLISA</span>(</span>
<span id="cb75-3"><a href="svp.html#cb75-3" tabindex="-1"></a>     <span class="at">features =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), </span>
<span id="cb75-4"><a href="svp.html#cb75-4" tabindex="-1"></a>     <span class="at">assay.type =</span> <span class="st">&#39;affi.score&#39;</span>,</span>
<span id="cb75-5"><a href="svp.html#cb75-5" tabindex="-1"></a>     <span class="at">weight.method =</span> <span class="st">&quot;knn&quot;</span>,</span>
<span id="cb75-6"><a href="svp.html#cb75-6" tabindex="-1"></a>     <span class="at">k =</span> <span class="dv">10</span>,</span>
<span id="cb75-7"><a href="svp.html#cb75-7" tabindex="-1"></a>     <span class="at">action =</span> <span class="st">&#39;get&#39;</span>,</span>
<span id="cb75-8"><a href="svp.html#cb75-8" tabindex="-1"></a>   )</span>
<span id="cb75-9"><a href="svp.html#cb75-9" tabindex="-1"></a>lisa.res12</span></code></pre></div>
<pre><code>## List of length 3
## names(3): Acinar cells Cancer clone A Cancer clone B</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="svp.html#cb77-1" tabindex="-1"></a>lisa.res12[[<span class="st">&#39;Acinar cells&#39;</span>]] <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##                 Gi       E.Gi       Var.Gi       Z.Gi
## Spot1 0.0003594390 0.00234192 1.553580e-06 -1.5905315
## Spot2 0.0008854181 0.00234192 1.551111e-06 -1.1694717
## Spot3 0.0013421397 0.00234192 1.551438e-06 -0.8026710
## Spot4 0.0011632261 0.00234192 1.563140e-06 -0.9427625
## Spot5 0.0011940380 0.00234192 1.557730e-06 -0.9197108
## Spot6 0.0008942096 0.00234192 1.551895e-06 -1.1621191
##       Pr (z != E(Gi)) cluster.no.test cluster.test
## Spot1       0.1117150             Low       NoSign
## Spot2       0.2422136             Low       NoSign
## Spot3       0.4221649             Low       NoSign
## Spot4       0.3458024             Low       NoSign
## Spot5       0.3577239             Low       NoSign
## Spot6       0.2451871             Low       NoSign</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="svp.html#cb79-1" tabindex="-1"></a>lisa.res12[[<span class="st">&quot;Cancer clone A&quot;</span>]] <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##                 Gi       E.Gi       Var.Gi      Z.Gi
## Spot1 0.0004249351 0.00234192 1.394101e-06 -1.623573
## Spot2 0.0003899767 0.00234192 1.393067e-06 -1.653793
## Spot3 0.0003702933 0.00234192 1.391701e-06 -1.671290
## Spot4 0.0004787373 0.00234192 1.391761e-06 -1.579331
## Spot5 0.0004788597 0.00234192 1.391386e-06 -1.579440
## Spot6 0.0005373218 0.00234192 1.393284e-06 -1.528836
##       Pr (z != E(Gi)) cluster.no.test cluster.test
## Spot1      0.10446707             Low       NoSign
## Spot2      0.09816948             Low       NoSign
## Spot3      0.09466441             Low       NoSign
## Spot4      0.11426017             Low       NoSign
## Spot5      0.11423509             Low       NoSign
## Spot6      0.12630517             Low       NoSign</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="svp.html#cb81-1" tabindex="-1"></a><span class="fu">colData</span>(hpda_spe_cell_dec)<span class="sc">$</span><span class="st">`</span><span class="at">cluster.test.Cancer.A</span><span class="st">`</span> <span class="ot">&lt;-</span> lisa.res12[[<span class="st">&quot;Cancer clone A&quot;</span>]] <span class="sc">|&gt;</span></span>
<span id="cb81-2"><a href="svp.html#cb81-2" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">pull</span>(cluster.test)</span>
<span id="cb81-3"><a href="svp.html#cb81-3" tabindex="-1"></a><span class="fu">colData</span>(hpda_spe_cell_dec)<span class="sc">$</span><span class="st">`</span><span class="at">cluster.test.Acinar</span><span class="st">`</span> <span class="ot">&lt;-</span> lisa.res12[[<span class="st">&quot;Acinar cells&quot;</span>]] <span class="sc">|&gt;</span></span>
<span id="cb81-4"><a href="svp.html#cb81-4" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">pull</span>(cluster.test)</span>
<span id="cb81-5"><a href="svp.html#cb81-5" tabindex="-1"></a><span class="fu">colData</span>(hpda_spe_cell_dec)<span class="sc">$</span><span class="st">`</span><span class="at">cluster.test.Cancer.B</span><span class="st">`</span> <span class="ot">&lt;-</span> lisa.res12[[<span class="st">&quot;Cancer clone B&quot;</span>]] <span class="sc">|&gt;</span></span>
<span id="cb81-6"><a href="svp.html#cb81-6" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">pull</span>(cluster.test)</span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="svp.html#cb82-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">sc_spatial</span>(hpda_spe_cell_dec,</span>
<span id="cb82-2"><a href="svp.html#cb82-2" tabindex="-1"></a>            <span class="at">features =</span> <span class="fu">rownames</span>(hpda_spe_cell_dec),</span>
<span id="cb82-3"><a href="svp.html#cb82-3" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">color=</span>cluster.test.Cancer.A),</span>
<span id="cb82-4"><a href="svp.html#cb82-4" tabindex="-1"></a>            <span class="at">plot.pie =</span> T,</span>
<span id="cb82-5"><a href="svp.html#cb82-5" tabindex="-1"></a>            <span class="at">pie.radius.scale =</span> .<span class="dv">8</span>,</span>
<span id="cb82-6"><a href="svp.html#cb82-6" tabindex="-1"></a>            <span class="at">bg_circle_radius =</span> <span class="fl">1.1</span>,</span>
<span id="cb82-7"><a href="svp.html#cb82-7" tabindex="-1"></a>            <span class="at">color=</span><span class="cn">NA</span>,</span>
<span id="cb82-8"><a href="svp.html#cb82-8" tabindex="-1"></a>            <span class="at">linewidth=</span><span class="dv">2</span></span>
<span id="cb82-9"><a href="svp.html#cb82-9" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;white&quot;</span>))</span>
<span id="cb82-10"><a href="svp.html#cb82-10" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="sclet_files/figure-html/svp-hpda-spatial-1-1.png" width="960" /></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="svp.html#cb83-1" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">sc_spatial</span>(hpda_spe_cell_dec, <span class="at">features=</span><span class="st">&quot;Cancer clone A&quot;</span>,</span>
<span id="cb83-2"><a href="svp.html#cb83-2" tabindex="-1"></a>            <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y),</span>
<span id="cb83-3"><a href="svp.html#cb83-3" tabindex="-1"></a>            <span class="at">pointsize=</span><span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb83-4"><a href="svp.html#cb83-4" tabindex="-1"></a>        <span class="fu">geom_scattermore2</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">bg_color=</span>cluster.test.Cancer.A, </span>
<span id="cb83-5"><a href="svp.html#cb83-5" tabindex="-1"></a>                          <span class="at">subset=</span>cluster.test.Cancer.A<span class="sc">==</span><span class="st">&quot;High&quot;</span>),</span>
<span id="cb83-6"><a href="svp.html#cb83-6" tabindex="-1"></a>                          <span class="at">bg_line_width =</span> .<span class="dv">16</span>,</span>
<span id="cb83-7"><a href="svp.html#cb83-7" tabindex="-1"></a>                          <span class="at">gap_line_width =</span> .<span class="dv">14</span>,</span>
<span id="cb83-8"><a href="svp.html#cb83-8" tabindex="-1"></a>                          <span class="at">pointsize =</span> <span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb83-9"><a href="svp.html#cb83-9" tabindex="-1"></a>        <span class="fu">scale_bg_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;black&#39;</span>))</span>
<span id="cb83-10"><a href="svp.html#cb83-10" tabindex="-1"></a>f1</span></code></pre></div>
<p><img src="sclet_files/figure-html/svp-hpda-spatial-2-1.png" width="960" /></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="svp.html#cb84-1" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">sc_spatial</span>(hpda_spe_cell_dec, <span class="at">features=</span><span class="st">&quot;Acinar cells&quot;</span>,</span>
<span id="cb84-2"><a href="svp.html#cb84-2" tabindex="-1"></a>            <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),</span>
<span id="cb84-3"><a href="svp.html#cb84-3" tabindex="-1"></a>            <span class="at">pointsize=</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb84-4"><a href="svp.html#cb84-4" tabindex="-1"></a>        <span class="fu">geom_scattermore2</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">bg_color=</span>cluster.test.Acinar, <span class="at">subset=</span>cluster.test.Acinar<span class="sc">==</span><span class="st">&quot;High&quot;</span>),</span>
<span id="cb84-5"><a href="svp.html#cb84-5" tabindex="-1"></a>                          <span class="at">bg_line_width =</span> .<span class="dv">16</span>,</span>
<span id="cb84-6"><a href="svp.html#cb84-6" tabindex="-1"></a>                          <span class="at">gap_line_width =</span> .<span class="dv">14</span>,</span>
<span id="cb84-7"><a href="svp.html#cb84-7" tabindex="-1"></a>                          <span class="at">pointsize =</span> <span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb84-8"><a href="svp.html#cb84-8" tabindex="-1"></a>        <span class="fu">scale_bg_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;black&#39;</span>))</span>
<span id="cb84-9"><a href="svp.html#cb84-9" tabindex="-1"></a>f2</span></code></pre></div>
<p><img src="sclet_files/figure-html/svp-hpda-spatial-3-1.png" width="960" /></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="svp.html#cb85-1" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="fu">sc_spatial</span>(hpda_spe_cell_dec, <span class="at">features=</span><span class="st">&quot;Cancer clone B&quot;</span>,</span>
<span id="cb85-2"><a href="svp.html#cb85-2" tabindex="-1"></a>            <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),</span>
<span id="cb85-3"><a href="svp.html#cb85-3" tabindex="-1"></a>            <span class="at">pointsize=</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb85-4"><a href="svp.html#cb85-4" tabindex="-1"></a>        <span class="fu">geom_scattermore2</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">bg_color=</span>cluster.test.Cancer.B, <span class="at">subset=</span>cluster.test.Cancer.B<span class="sc">==</span><span class="st">&quot;High&quot;</span>),</span>
<span id="cb85-5"><a href="svp.html#cb85-5" tabindex="-1"></a>                          <span class="at">bg_line_width =</span> .<span class="dv">18</span>,</span>
<span id="cb85-6"><a href="svp.html#cb85-6" tabindex="-1"></a>                          <span class="at">gap_line_width =</span> .<span class="dv">14</span>,</span>
<span id="cb85-7"><a href="svp.html#cb85-7" tabindex="-1"></a>                          <span class="at">pointsize =</span> <span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb85-8"><a href="svp.html#cb85-8" tabindex="-1"></a>        <span class="fu">scale_bg_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;black&#39;</span>))</span>
<span id="cb85-9"><a href="svp.html#cb85-9" tabindex="-1"></a>f3</span></code></pre></div>
<p><img src="sclet_files/figure-html/svp-hpda-spatial-4-1.png" width="960" /></p>
</div>
<div id="runlocalbv" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> runLOCALBV<a href="svp.html#runlocalbv" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>explore the local bivariate relationship in the spatial space.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="svp.html#cb86-1" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> hpda_spe_cell_dec <span class="sc">|&gt;</span> <span class="fu">runLOCALBV</span>(</span>
<span id="cb86-2"><a href="svp.html#cb86-2" tabindex="-1"></a>          <span class="at">features1 =</span> <span class="st">&#39;Cancer clone A&#39;</span>, </span>
<span id="cb86-3"><a href="svp.html#cb86-3" tabindex="-1"></a>          <span class="at">features2 =</span> <span class="st">&#39;Cancer clone B&#39;</span>, </span>
<span id="cb86-4"><a href="svp.html#cb86-4" tabindex="-1"></a>          <span class="at">assay.type=</span><span class="st">&#39;affi.score&#39;</span></span>
<span id="cb86-5"><a href="svp.html#cb86-5" tabindex="-1"></a>        )</span>
<span id="cb86-6"><a href="svp.html#cb86-6" tabindex="-1"></a>res1</span>
<span id="cb86-7"><a href="svp.html#cb86-7" tabindex="-1"></a>res1[[<span class="st">&#39;Cancer clone A_VS_Cancer clone B&#39;</span>]] <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb86-8"><a href="svp.html#cb86-8" tabindex="-1"></a></span>
<span id="cb86-9"><a href="svp.html#cb86-9" tabindex="-1"></a></span>
<span id="cb86-10"><a href="svp.html#cb86-10" tabindex="-1"></a><span class="co">#        LocalLee           Gi       E.Gi       Var.Gi       Z.Gi Pr (z &gt; E(Gi)) cluster.no.test cluster.test</span></span>
<span id="cb86-11"><a href="svp.html#cb86-11" tabindex="-1"></a><span class="co"># Spot1 0.2656572 0.0007993283 0.00234192 1.685012e-06 -1.1883644      0.8826551             Low       NoSign</span></span>
<span id="cb86-12"><a href="svp.html#cb86-12" tabindex="-1"></a><span class="co"># Spot2 0.1928726 0.0006520670 0.00234192 3.060135e-06 -0.9660035      0.8329788             Low       NoSign</span></span>
<span id="cb86-13"><a href="svp.html#cb86-13" tabindex="-1"></a><span class="co"># Spot3 0.2098906 0.0007134499 0.00234192 2.544445e-06 -1.0209003      0.8463492             Low       NoSign</span></span>
<span id="cb86-14"><a href="svp.html#cb86-14" tabindex="-1"></a><span class="co"># Spot4 0.2609793 0.0007131499 0.00234192 2.545557e-06 -1.0208654      0.8463409             Low       NoSign</span></span>
<span id="cb86-15"><a href="svp.html#cb86-15" tabindex="-1"></a><span class="co"># Spot5 0.1769749 0.0007300670 0.00234192 3.059710e-06 -0.9214789      0.8215998             Low       NoSign</span></span>
<span id="cb86-16"><a href="svp.html#cb86-16" tabindex="-1"></a><span class="co"># Spot6 0.1736672 0.0004656579 0.00234192 2.175086e-06 -1.2721999      0.8983489             Low       NoSign</span></span></code></pre></div>

</div>
</div>






            </section>

          </div>
        </div>
      </div>
<a href="cell-cell-communication.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
