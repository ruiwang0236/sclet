[["index.html", "sclet: A Lightweight Toolkit for Single-Cell Data Analysis Preface", " sclet: A Lightweight Toolkit for Single-Cell Data Analysis Guangchuang Yu Department of Bioinformatics, School of Basic Medical Sciences, Southern Medical University guangchuangyu@gmail.com 2024-10-07 Preface Hello World. "],["basic-preprocessing-and-clustering.html", "1 Basic: preprocessing and clustering 1.1 Read 10X data 1.2 QC 1.3 Variable features 1.4 Dimensional reduction 1.5 Clustering 1.6 UMAP 1.7 Find Markers 1.8 Cell cluster annotation", " 1 Basic: preprocessing and clustering We created Seurat-like functions to help you get started effortlessly. 1.1 Read 10X data library(sclet) dir &lt;- &quot;filtered_gene_bc_matrices/hg19&quot; sce &lt;- Read10X(dir) 1.2 QC # colData(sce)$percent.mt &lt;- PercentageFeatureSet(sce, &quot;^MT-&quot;) sce[[&quot;percent.mt&quot;]] &lt;- PercentageFeatureSet(sce, &quot;^MT-&quot;) VlnPlot(sce, features = c(&quot;nFeature_RNA&quot;, &quot;nCount_RNA&quot;, &quot;percent.mt&quot;)) subset_feature(sce, 10) ## ************************************************** &gt;=0 | 32738 (100%) ## ************************* &gt;=1 | 16634 (51%) ## ********************** &gt;=2 | 14702 (45%) ## ********************* &gt;=3 | 13714 (42%) ## ******************** &gt;=4 | 13034 (40%) ## ******************* &gt;=5 | 12572 (38%) ## ******************* &gt;=6 | 12198 (37%) ## ****************** &gt;=7 | 11876 (36%) ## ****************** &gt;=8 | 11627 (36%) ## ***************** &gt;=9 | 11379 (35%) ## ***************** &gt;=10 | 11139 (34%) sce &lt;- subset_feature(sce, mincell = 3, peek=FALSE) sce &lt;- subset(sce, subset = nFeature_RNA &gt; 200 &amp; nFeature_RNA &lt; 2500 &amp; percent.mt &lt; 5) sce ## class: SingleCellExperiment ## dim: 13714 2638 ## metadata(1): Samples ## assays(1): counts ## rownames(13714): AL627309.1 AP006222.2 ... ## PNRC2_ENSG00000215700 SRSF10_ENSG00000215699 ## rowData names(2): ID Symbol ## colnames: NULL ## colData names(5): Sample Barcode nFeature_RNA ## nCount_RNA percent.mt ## reducedDimNames(0): ## mainExpName: NULL ## altExpNames(0): plot1 &lt;- FeatureScatter(sce, feature1 = &quot;nCount_RNA&quot;, feature2 = &quot;percent.mt&quot;) plot2 &lt;- FeatureScatter(sce, feature1 = &quot;nCount_RNA&quot;, feature2 = &quot;nFeature_RNA&quot;) library(aplot) plot_list(plot1, plot2) Users can also use plotColData() to visualize the QC data. # VlnPlot-like p1 &lt;- plotColData(sce, y = &#39;nCount_RNA&#39;) # FeatureScatter-like p2 &lt;- plotColData(sce, x = &quot;nCount_RNA&quot;, y = &quot;percent.mt&quot;) plot_list(p1, p2) 1.3 Variable features sce &lt;- NormalizeData(sce) sce &lt;- FindVariableFeatures(sce) top10 &lt;- head(VariableFeatures(sce), 10) top10 ## [1] &quot;PPBP&quot; &quot;LYZ&quot; &quot;S100A9&quot; &quot;IGLL5&quot; &quot;GNLY&quot; &quot;FTL&quot; ## [7] &quot;PF4&quot; &quot;FTH1&quot; &quot;GNG11&quot; &quot;S100A8&quot; VariableFeaturePlot(sce, label = top10) 1.4 Dimensional reduction sce &lt;- ScaleData(sce) sce &lt;- runPCA(sce, subset_row = VariableFeatures(sce), exprs_values = &quot;scaled&quot;) ElbowPlot(sce) 1.5 Clustering set.seed(2024-10-01) sce &lt;- FindNeighbors(sce, dims = 1:10) sce &lt;- FindClusters(sce) head(Idents(sce), 5) ## AAACATACAACCAC-1 AAACATTGAGCTAC-1 AAACATTGATCAGC-1 ## 1 2 3 ## AAACCGTGCTTCCG-1 AAACCGTGTATGCG-1 ## 4 5 ## Levels: 1 2 3 4 5 6 7 8 9 1.6 UMAP sce &lt;- RunUMAP(sce, 1:10) library(ggsc) library(aplot) p1 &lt;- sc_dim(sce, reduction=&quot;PCA&quot;) p2 &lt;- sc_dim(sce, reduction=&quot;UMAP&quot;) plot_list(gglist = list(PCA=p1, UMAP=p2)) 1.7 Find Markers # find all markers of cluster 2 cluster2.markers &lt;- FindMarkers(sce, ident.1 = 2) head(cluster2.markers, n = 5) ## pval padj avg_log2FC pct.1 pct.2 ## CD79A 5.305484e-102 7.275940e-98 68.33509 1 0.052 ## CD74 1.995011e-87 1.367979e-83 -106.95385 1 0.787 ## CD79B 2.013334e-85 9.203619e-82 54.24136 1 0.141 ## MS4A1 1.920813e-84 6.585508e-81 46.48265 1 0.062 ## HLA-DQA1 2.199464e-82 6.032690e-79 10.08589 1 0.098 # find all markers distinguishing cluster 5 from clusters 0 and 3 cluster5.markers &lt;- FindMarkers(sce, ident.1 = 5, ident.2 = c(0, 3)) head(cluster5.markers, n = 5) ## pval padj avg_log2FC pct.1 pct.2 ## GZMB 4.691392e-80 6.433775e-76 156.62778 1 0.040 ## NKG7 3.980428e-78 2.729380e-74 100.09227 1 0.172 ## GNLY 5.141676e-77 2.350431e-73 111.81262 1 0.120 ## PRF1 3.439975e-72 1.179396e-68 65.89194 1 0.091 ## CST7 2.280830e-69 6.255860e-66 54.83849 1 0.135 # find markers for every cluster compared to all remaining cells, # report only the positive ones library(dplyr) pbmc.markers &lt;- FindAllMarkers(sce, only.pos = TRUE) topN_marker &lt;- function(markers, n) { markers %&gt;% group_by(cluster) %&gt;% dplyr::filter(avg_log2FC &gt; 1) %&gt;% slice_head(n = n) %&gt;% ungroup() } top10 &lt;- topN_marker(pbmc.markers, 10) split(top10$gene, top10$cluster) ## $`1` ## [1] &quot;CCL5&quot; &quot;NKG7&quot; &quot;GZMK&quot; &quot;CST7&quot; &quot;CTSW&quot; ## [6] &quot;IL32&quot; &quot;TMSB10&quot; &quot;CD8A&quot; &quot;C1orf162&quot; &quot;KLRG1&quot; ## ## $`2` ## [1] &quot;CD79A&quot; &quot;CD79B&quot; &quot;MS4A1&quot; &quot;HLA-DQA1&quot; ## [5] &quot;HLA-DQB1&quot; &quot;TCL1A&quot; &quot;LINC00926&quot; &quot;VPREB3&quot; ## [9] &quot;SRGN&quot; &quot;HLA-DQA2&quot; ## ## $`3` ## [1] &quot;LTB&quot; &quot;LDHB&quot; &quot;IL32&quot; &quot;IL7R&quot; &quot;CD3D&quot; &quot;RPS3&quot; &quot;RPS25&quot; ## [8] &quot;RPS27&quot; &quot;RPS12&quot; &quot;RPS18&quot; ## ## $`4` ## [1] &quot;S100A9&quot; &quot;S100A8&quot; &quot;LYZ&quot; &quot;LGALS2&quot; &quot;FCN1&quot; &quot;TYROBP&quot; ## [7] &quot;CST3&quot; &quot;FTL&quot; &quot;FTH1&quot; &quot;GPX1&quot; ## ## $`5` ## [1] &quot;GZMB&quot; &quot;GNLY&quot; &quot;NKG7&quot; &quot;PRF1&quot; &quot;FGFBP2&quot; &quot;GZMA&quot; ## [7] &quot;CST7&quot; &quot;CTSW&quot; &quot;SPON2&quot; &quot;CD247&quot; ## ## $`6` ## [1] &quot;FCGR3A&quot; &quot;LST1&quot; &quot;FCER1G&quot; ## [4] &quot;IFITM3&quot; &quot;SERPINA1&quot; &quot;COTL1&quot; ## [7] &quot;RP11-290F20.3&quot; &quot;MS4A7&quot; &quot;IFITM2&quot; ## [10] &quot;FTL&quot; ## ## $`7` ## [1] &quot;RPS27&quot; &quot;MALAT1&quot; &quot;RPL32&quot; &quot;RPL9&quot; &quot;SH3BGRL3&quot; ## [6] &quot;RPS25&quot; &quot;RPL30&quot; &quot;RPS12&quot; &quot;RPL21&quot; &quot;RPS13&quot; ## ## $`8` ## [1] &quot;FCER1A&quot; &quot;ENHO&quot; &quot;PHACTR1&quot; &quot;CLEC10A&quot; &quot;CD1C&quot; ## [6] &quot;SERPINF1&quot; &quot;CLIC2&quot; &quot;HLA-DQA2&quot; &quot;GSN&quot; &quot;NDRG2&quot; ## ## $`9` ## [1] &quot;PF4&quot; &quot;GP9&quot; &quot;ITGA2B&quot; &quot;AP001189.4&quot; ## [5] &quot;GNG11&quot; &quot;SDPR&quot; &quot;TMEM40&quot; &quot;TUBB1&quot; ## [9] &quot;SPARC&quot; &quot;PTCRA&quot; 1.7.1 Marker gene information top1 &lt;- topN_marker(pbmc.markers, 1) gene_table &lt;- gene_summary_table(top1, gene_col = &#39;gene&#39;, cluster_col = &#39;cluster&#39;, keyType=&#39;SYMBOL&#39;, output = &quot;data.frame&quot;) gene_table ## ENTREZID gene pval padj avg_log2FC ## 1 2205 FCER1A 1.512234e-51 2.073878e-47 66.02055 ## 2 2214 FCGR3A 8.939859e-77 1.226012e-72 26.60405 ## 3 3002 GZMB 4.753779e-82 6.519332e-78 148.98625 ## 4 4050 LTB 2.222889e-52 3.048470e-48 59.65963 ## 5 5196 PF4 3.554569e-72 4.874736e-68 92.82031 ## 6 6232 RPS27 4.326148e-45 8.475542e-42 10.60607 ## 7 6280 S100A9 6.246079e-116 8.565872e-112 226.06146 ## 8 6352 CCL5 4.316148e-98 5.919165e-94 67.29457 ## 9 973 CD79A 5.305484e-102 7.275940e-98 68.33509 ## pct.1 pct.2 cluster name ## 1 1 0.012 8 FCER1A ## 2 1 0.143 6 FCGR3A ## 3 1 0.073 5 GZMB ## 4 1 0.651 3 LTB ## 5 1 0.003 9 PF4 ## 6 1 0.996 7 RPS27 ## 7 1 0.205 4 S100A9 ## 8 1 0.224 1 CCL5 ## 9 1 0.052 2 CD79A ## description ## 1 Fc epsilon receptor Ia ## 2 Fc gamma receptor IIIa ## 3 granzyme B ## 4 lymphotoxin beta ## 5 platelet factor 4 ## 6 ribosomal protein S27 ## 7 S100 calcium binding protein A9 ## 8 C-C motif chemokine ligand 5 ## 9 CD79a molecule ## summary ## 1 The immunoglobulin epsilon receptor (IgE receptor) is the initiator of the allergic response. When two or more high-affinity IgE receptors are brought together by allergen-bound IgE molecules, mediators such as histamine that are responsible for allergy symptoms are released. This receptor is comprised of an alpha subunit, a beta subunit, and two gamma subunits. The protein encoded by this gene represents the alpha subunit. [provided by RefSeq, Aug 2011] ## 2 This gene encodes a receptor for the Fc portion of immunoglobulin G, and it is involved in the removal of antigen-antibody complexes from the circulation, as well as other responses, including antibody dependent cellular mediated cytotoxicity and antibody dependent enhancement of virus infections. This gene (FCGR3A) is highly similar to another nearby gene (FCGR3B) located on chromosome 1. The receptor encoded by this gene is expressed on natural killer (NK) cells as an integral membrane glycoprotein anchored through a transmembrane peptide, whereas FCGR3B is expressed on polymorphonuclear neutrophils (PMN) where the receptor is anchored through a phosphatidylinositol (PI) linkage. Mutations in this gene are associated with immunodeficiency 20, and have been linked to susceptibility to recurrent viral infections, susceptibility to systemic lupus erythematosus, and alloimmune neonatal neutropenia. Alternatively spliced transcript variants encoding different isoforms have been found for this gene. [provided by RefSeq, Aug 2020] ## 3 This gene encodes a member of the granzyme subfamily of proteins, part of the peptidase S1 family of serine proteases. The encoded preproprotein is secreted by natural killer (NK) cells and cytotoxic T lymphocytes (CTLs) and proteolytically processed to generate the active protease, which induces target cell apoptosis. This protein also processes cytokines and degrades extracellular matrix proteins, and these roles are implicated in chronic inflammation and wound healing. Expression of this gene may be elevated in human patients with cardiac fibrosis. [provided by RefSeq, Sep 2016] ## 4 Lymphotoxin beta is a type II membrane protein of the TNF family. It anchors lymphotoxin-alpha to the cell surface through heterotrimer formation. The predominant form on the lymphocyte surface is the lymphotoxin-alpha 1/beta 2 complex (e.g. 1 molecule alpha/2 molecules beta) and this complex is the primary ligand for the lymphotoxin-beta receptor. The minor complex is lymphotoxin-alpha 2/beta 1. LTB is an inducer of the inflammatory response system and involved in normal development of lymphoid tissue. Lymphotoxin-beta isoform b is unable to complex with lymphotoxin-alpha suggesting a function for lymphotoxin-beta which is independent of lympyhotoxin-alpha. Alternative splicing results in multiple transcript variants encoding different isoforms. [provided by RefSeq, Jul 2008] ## 5 This gene encodes a member of the CXC chemokine family. This chemokine is released from the alpha granules of activated platelets in the form of a homotetramer which has high affinity for heparin and is involved in platelet aggregation. This protein is chemotactic for numerous other cell type and also functions as an inhibitor of hematopoiesis, angiogenesis and T-cell function. The protein also exhibits antimicrobial activity against Plasmodium falciparum. [provided by RefSeq, Oct 2014] ## 6 Ribosomes, the organelles that catalyze protein synthesis, consist of a small 40S subunit and a large 60S subunit. Together these subunits are composed of four RNA species and approximately 80 structurally distinct proteins. This gene encodes a member of the S27e family of ribosomal proteins and component of the 40S subunit. The encoded protein contains a C4-type zinc finger domain that can bind to zinc and may bind to nucleic acid. Mutations in this gene have been identified in numerous melanoma patients and in at least one patient with Diamond-Blackfan anemia (DBA). Elevated expression of this gene has been observed in various human cancers. As is typical for genes encoding ribosomal proteins, there are multiple processed pseudogenes of this gene dispersed through the genome. [provided by RefSeq, Jul 2018] ## 7 The protein encoded by this gene is a member of the S100 family of proteins containing 2 EF-hand calcium-binding motifs. S100 proteins are localized in the cytoplasm and/or nucleus of a wide range of cells, and involved in the regulation of a number of cellular processes such as cell cycle progression and differentiation. S100 genes include at least 13 members which are located as a cluster on chromosome 1q21. This protein may function in the inhibition of casein kinase and altered expression of this protein is associated with the disease cystic fibrosis. This antimicrobial protein exhibits antifungal and antibacterial activity. [provided by RefSeq, Nov 2014] ## 8 This gene is one of several chemokine genes clustered on the q-arm of chromosome 17. Chemokines form a superfamily of secreted proteins involved in immunoregulatory and inflammatory processes. The superfamily is divided into four subfamilies based on the arrangement of the N-terminal cysteine residues of the mature peptide. This chemokine, a member of the CC subfamily, functions as a chemoattractant for blood monocytes, memory T helper cells and eosinophils. It causes the release of histamine from basophils and activates eosinophils. This cytokine is one of the major HIV-suppressive factors produced by CD8+ cells. It functions as one of the natural ligands for the chemokine receptor chemokine (C-C motif) receptor 5 (CCR5), and it suppresses in vitro replication of the R5 strains of HIV-1, which use CCR5 as a coreceptor. Alternative splicing results in multiple transcript variants that encode different isoforms. [provided by RefSeq, Jul 2013] ## 9 The B lymphocyte antigen receptor is a multimeric complex that includes the antigen-specific component, surface immunoglobulin (Ig). Surface Ig non-covalently associates with two other proteins, Ig-alpha and Ig-beta, which are necessary for expression and function of the B-cell antigen receptor. This gene encodes the Ig-alpha protein of the B-cell antigen component. Alternatively spliced transcript variants encoding different isoforms have been described. [provided by RefSeq, Jul 2008] 1.8 Cell cluster annotation new_labels &lt;- c(&quot;CD8+ T&quot;,&quot;B&quot;,&quot;Memory CD4+&quot;,&quot;CD14+ Mono&quot;, &quot;NK&quot;,&quot;FCGR3A+ Mono&quot;,&quot;Native CD4+ T&quot;,&quot;DC&quot;,&quot;Platelet&quot;) sce &lt;- RenameIdents(sce, new_labels) sc_dim(sce, reduction=&quot;UMAP&quot;) + sc_dim_geom_label() "],["cell-cell-communication.html", "2 Cell-cell communication 2.1 Input 2.2 CellChat 2.3 visulization", " 2 Cell-cell communication 2.1 Input The runCellChat() function requires a SingleCellExperiment object that includes cell clustering information. For details, refer to the Clustering session. The group parameter should reference a variable within the SingleCellExperiment object that holds the clustering data. Users can add their own clustering using the following commands: colData(sce)$group_name &lt;- group # OR sce[[&quot;group_name&quot;]] &lt;- group 2.2 CellChat Wrapper function for CellChat. See also https://htmlpreview.github.io/?https://github.com/jinworks/CellChat/blob/master/tutorial/CellChat-vignette.html#c-starting-from-a-singlecellexperiment-object library(sclet) library(aplot) # use demo data from CellChat, hmskin_sce sce &lt;- qs::qread(&quot;data/hmskin_sce.qs&quot;) cci_obj &lt;- runCellChat(sce, group = &quot;labels&quot;) ## [1] &quot;Create a CellChat object from a data matrix&quot; ## Set cell identities for the new CellChat object ## The cell groups used for CellChat analysis are APOE+ FIB, FBN1+ FIB, COL11A1+ FIB, Inflam. FIB, cDC1, cDC2, LC, Inflam. DC, TC, Inflam. TC, CD40LG+ TC, NKT ## The number of highly variable ligand-receptor pairs used for signaling inference is 693 ## triMean is used for calculating the average gene expression per cell group. ## [1] &quot;&gt;&gt;&gt; Run CellChat on sc/snRNA-seq data &lt;&lt;&lt; [2024-10-07 10:13:55.880406]&quot; ## [1] &quot;&gt;&gt;&gt; CellChat inference is done. Parameter values are stored in `object@options$parameter` &lt;&lt;&lt; [2024-10-07 10:16:17.158039]&quot; 2.3 visulization groupSize &lt;- as.numeric(table(cci_obj@idents)) plot_list( ~CellChat::netVisual_circle(cci_obj@net$count, vertex.weight = groupSize, weight.scale = T, label.edge= F, title.name = &quot;Number of interactions&quot;), ~CellChat::netVisual_circle(cci_obj@net$weight, vertex.weight = groupSize, weight.scale = T, label.edge= F, title.name = &quot;Interaction weights/strength&quot;) ) pathways.show &lt;- c(&quot;CXCL&quot;) vertex.receiver = seq(1,4) # CellChat::netVisual_aggregate(cci_obj, signaling = pathways.show, vertex.receiver = vertex.receiver) CellChat::netVisual_aggregate(cci_obj, signaling = pathways.show, layout = &quot;circle&quot;) CellChat::netVisual_aggregate(cci_obj, signaling = pathways.show, layout = &quot;chord&quot;) CellChat::netVisual_heatmap(cci_obj, signaling = pathways.show, color.heatmap = &quot;Reds&quot;) group.cellType &lt;- c(rep(&quot;FIB&quot;, 4), rep(&quot;DC&quot;, 4), rep(&quot;TC&quot;, 4)) # grouping cell clusters into fibroblast, DC and TC cells names(group.cellType) &lt;- levels(cci_obj@idents) CellChat::netVisual_chord_cell(cci_obj, signaling = pathways.show, group = group.cellType, title.name = paste0(pathways.show, &quot; signaling network&quot;)) CellChat::netAnalysis_contribution(cci_obj, signaling = pathways.show) pairLR.CXCL &lt;- CellChat::extractEnrichedLR(cci_obj, signaling = pathways.show, geneLR.return = FALSE) LR.show &lt;- pairLR.CXCL[1,] vertex.receiver = seq(1,4) # CellChat::netVisual_individual(cci_obj, signaling = pathways.show, pairLR.use = LR.show, vertex.receiver = vertex.receiver) CellChat::netVisual_individual(cci_obj, signaling = pathways.show, pairLR.use = LR.show, layout = &quot;circle&quot;) ## [[1]] CellChat::netVisual_individual(cci_obj, signaling = pathways.show, pairLR.use = LR.show, layout = &quot;chord&quot;) ## [[1]] CellChat::netVisual_bubble(cci_obj, sources.use = 4, targets.use = c(5:11), remove.isolate = FALSE) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
